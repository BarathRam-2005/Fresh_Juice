{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import OrderTracker from'../components/OrderTracker';import{api}from'../services/api';import'./TrackOrder.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TrackOrder=()=>{var _order$_id,_order$total;const[currentStage,setCurrentStage]=useState(0);const[order,setOrder]=useState(null);const[loading,setLoading]=useState(true);const[timeElapsed,setTimeElapsed]=useState(0);const[deliveryPerson,setDeliveryPerson]=useState(null);const[user,setUser]=useState(null);const navigate=useNavigate();const location=useLocation();// Get user from localStorage\nuseEffect(()=>{const savedUser=localStorage.getItem('rypeUser');if(savedUser){try{const userData=JSON.parse(savedUser);setUser(userData);console.log('User loaded:',userData);}catch(e){console.error('Error parsing user data:',e);}}else{console.log('No user found in localStorage');setLoading(false);}},[]);// Save order to localStorage whenever it changes\nuseEffect(()=>{if(order){localStorage.setItem('rypeCurrentOrder',JSON.stringify({order,timestamp:new Date().toISOString(),timeElapsed,currentStage}));console.log('Order saved to localStorage');}},[order,timeElapsed,currentStage]);// Load order from localStorage or location state\nuseEffect(()=>{var _location$state;console.log('Location state:',location.state);// First, check if we have a new order from location state\nif((_location$state=location.state)!==null&&_location$state!==void 0&&_location$state.order){console.log('New order received from location state');const newOrder=location.state.order;setOrder(newOrder);setTimeElapsed(0);setCurrentStage(0);// Clear any old order from localStorage and set new one\nlocalStorage.setItem('rypeCurrentOrder',JSON.stringify({order:newOrder,timestamp:new Date().toISOString(),timeElapsed:0,currentStage:0}));setLoading(false);return;}// If no location state, check localStorage for existing order\nconst savedOrderData=localStorage.getItem('rypeCurrentOrder');if(savedOrderData){try{const orderData=JSON.parse(savedOrderData);console.log('Found saved order in localStorage:',orderData);// Check if the order is still valid (less than 15 minutes old)\nconst savedTime=new Date(orderData.timestamp);const currentTime=new Date();const minutesSinceSaved=Math.floor((currentTime-savedTime)/(1000*60));if(minutesSinceSaved<15){// Keep order for 15 minutes\nconsole.log('Order is still valid, loading from localStorage');setOrder(orderData.order);setTimeElapsed(orderData.timeElapsed+minutesSinceSaved);// Add elapsed time since last save\nsetCurrentStage(orderData.currentStage);}else{console.log('Order is too old, clearing from localStorage');localStorage.removeItem('rypeCurrentOrder');}}catch(e){console.error('Error parsing saved order data:',e);localStorage.removeItem('rypeCurrentOrder');}}setLoading(false);},[location.state]);// Fetch user's latest order from API only if no order from localStorage or location state\nuseEffect(()=>{const fetchLatestOrder=async()=>{if(!user||order){// Don't fetch if we already have an order\nreturn;}try{console.log('Fetching latest order from API for user:',user.id);const ordersResponse=await api.getUserOrders();console.log('Orders API response:',ordersResponse);if(ordersResponse.success&&Array.isArray(ordersResponse.orders)&&ordersResponse.orders.length>0){// Get the most recent order\nconst latestOrder=ordersResponse.orders[0];console.log('Latest order found from API:',latestOrder);// Check if this order is recent (within 15 minutes)\nconst orderTime=new Date(latestOrder.createdAt);const currentTime=new Date();const minutesSinceOrder=Math.floor((currentTime-orderTime)/(1000*60));if(minutesSinceOrder<15){setOrder(latestOrder);setTimeElapsed(minutesSinceOrder);// Set initial stage based on order status and time\nconst stage=calculateStageBasedOnTime(minutesSinceOrder,latestOrder.status);setCurrentStage(stage);// Save to localStorage\nlocalStorage.setItem('rypeCurrentOrder',JSON.stringify({order:latestOrder,timestamp:new Date().toISOString(),timeElapsed:minutesSinceOrder,currentStage:stage}));}}}catch(error){console.error('Error fetching order from API:',error);}};if(user&&!order&&!loading){fetchLatestOrder();}},[user,order,loading]);// Calculate stage based on time and status\nconst calculateStageBasedOnTime=(minutes,status)=>{const statusToStage={'pending':0,'preparing':1,'quality-check':2,'out-for-delivery':3,'delivered':4};// If we have a status, use it\nif(status&&statusToStage[status]!==undefined){return statusToStage[status];}// Otherwise calculate based on time\nif(minutes>=15)return 4;// Delivered\nif(minutes>=8)return 3;// Out for delivery\nif(minutes>=5)return 2;// Quality check\nif(minutes>=2)return 1;// Preparing\nreturn 0;// Order placed\n};// Simulate order progress\nuseEffect(()=>{if(!order)return;const interval=setInterval(()=>{setTimeElapsed(prev=>{const newTime=prev+1;console.log(\"Time elapsed: \".concat(newTime,\" minutes, Current stage: \").concat(currentStage));// Auto-progress through stages based on time\nif(newTime>=2&&currentStage<1){setCurrentStage(1);// Move to preparing\n}else if(newTime>=5&&currentStage<2){setCurrentStage(2);// Move to quality check\n}else if(newTime>=8&&currentStage<3){setCurrentStage(3);// Move to out for delivery\n}else if(newTime>=15&&currentStage<4){setCurrentStage(4);// Move to delivered\n// Clear order from localStorage after 15 minutes when delivered\nsetTimeout(()=>{localStorage.removeItem('rypeCurrentOrder');console.log('Order cleared from localStorage after completion');},5000);// Clear 5 seconds after delivery\n}// Simulate delivery person assignment\nif(currentStage>=3&&!deliveryPerson){setDeliveryPerson({name:'Raj Kumar',rating:4.8,vehicle:'üö¥ Bicycle',phone:'+91 98765 43210',location:'1.2 km away',eta:\"\".concat(Math.max(1,25-newTime),\" minutes\")});}return newTime;});},60000);// Update every minute\nreturn()=>clearInterval(interval);},[order,deliveryPerson,currentStage]);// Clear order after 15 minutes (safety mechanism)\nuseEffect(()=>{if(timeElapsed>=15){const timer=setTimeout(()=>{console.log('Auto-clearing order after 15 minutes');localStorage.removeItem('rypeCurrentOrder');setOrder(null);},300000);// 5 minutes after delivery (20 minutes total)\nreturn()=>clearTimeout(timer);}},[timeElapsed]);// Debug: Log current state\nuseEffect(()=>{var _location$state2;console.log('Current TrackOrder state:',{user:!!user,order:!!order,loading,timeElapsed,currentStage,hasLocationState:!!((_location$state2=location.state)!==null&&_location$state2!==void 0&&_location$state2.order)});},[user,order,loading,timeElapsed,currentStage,location.state]);// Clear current order (manual function)\nconst clearCurrentOrder=()=>{localStorage.removeItem('rypeCurrentOrder');setOrder(null);setTimeElapsed(0);setCurrentStage(0);setDeliveryPerson(null);console.log('Order manually cleared');};// Redirect to menu if no user\nif(!user){return/*#__PURE__*/_jsx(\"div\",{className:\"track-order-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDD10\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Please Login to Track Orders\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You need to be logged in to view your order tracking information.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>navigate('/'),children:\"Go to Home\"})]})});}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"track-order-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading your order details...\"})]})});}if(!order){return/*#__PURE__*/_jsx(\"div\",{className:\"track-order-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCE6\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"No Active Orders\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You haven't placed any orders recently, or your previous order has been completed.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"empty-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>navigate('/menu'),children:\"Order Fresh Juices\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:()=>navigate('/history'),children:\"View Order History\"})]})]})});}const orderStages=[{id:1,name:\"Order Placed\",description:\"We've received your order and payment\",icon:\"üìù\",time:\"Just now\"},{id:2,name:\"Preparing\",description:\"Squeezing fresh fruits and preparing your juices\",icon:\"üë®‚Äçüç≥\",time:\"3-5 minutes\"},{id:3,name:\"Quality Check\",description:\"Ensuring perfect taste and freshness\",icon:\"üîç\",time:\"2-3 minutes\"},{id:4,name:\"Out for Delivery\",description:\"Your juices are on the way!\",icon:\"üöö\",time:\"10-15 minutes\"},{id:5,name:\"Delivered\",description:\"Enjoy your fresh juices!\",icon:\"‚úÖ\",time:\"Arrived\"}];const progressPercentage=Math.min(timeElapsed/15*100,100);return/*#__PURE__*/_jsxs(\"div\",{className:\"track-order-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Track Your Order\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Order #\",((_order$_id=order._id)===null||_order$_id===void 0?void 0:_order$_id.substring(18))||order.id,\" \\u2022 Placed \",new Date(order.createdAt).toLocaleTimeString()]}),/*#__PURE__*/_jsx(\"button\",{className:\"clear-order-btn\",onClick:clearCurrentOrder,title:\"Clear this order\",children:\"\\uD83D\\uDDD1\\uFE0F Clear\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Delivery Progress\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"time-elapsed\",children:[timeElapsed,\" min elapsed\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",style:{width:\"\".concat(progressPercentage,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-labels\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Ordered\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Estimated: \",order.estimatedDelivery?new Date(order.estimatedDelivery).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}):'15-20 minutes']})]})]}),/*#__PURE__*/_jsx(OrderTracker,{currentStage:currentStage,orderStages:orderStages,timeElapsed:timeElapsed}),deliveryPerson&&/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-person-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDEF5 Your Delivery Partner\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-person-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"person-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"person-avatar\",children:deliveryPerson.name.split(' ').map(n=>n[0]).join('')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:deliveryPerson.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u2B50 \",deliveryPerson.rating,\" \\u2022 \",deliveryPerson.vehicle]}),/*#__PURE__*/_jsxs(\"p\",{className:\"location\",children:[\"\\uD83D\\uDCCD \",deliveryPerson.location]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"ETA: \",deliveryPerson.eta]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",children:\"\\uD83D\\uDCDE Call\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",children:\"\\uD83D\\uDCAC Message\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-details-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Your Order Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-items-list\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Items Ordered:\"}),order.items&&order.items.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-image\",children:item.image||'üçä'}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:item.name||'Fresh Juice'}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Quantity: \",item.quantity||1]})]})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-price\",children:[\"\\u20B9\",((item.price||0)*(item.quantity||1)).toFixed(2)]})]},index))]}),/*#__PURE__*/_jsx(\"div\",{className:\"order-total\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"Total: \\u20B9\",((_order$total=order.total)===null||_order$total===void 0?void 0:_order$total.toFixed(2))||'0.00']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Delivery Information:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCE6 Delivery Address:\"}),/*#__PURE__*/_jsx(\"span\",{children:order.address||user.address||'Address not specified'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC64 Customer:\"}),/*#__PURE__*/_jsx(\"span\",{children:user.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCDE Contact:\"}),/*#__PURE__*/_jsx(\"span\",{children:user.phone||'Not provided'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u23F0 Ordered at:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(order.createdAt).toLocaleString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCB3 Payment Method:\"}),/*#__PURE__*/_jsx(\"span\",{children:order.paymentMethod||'Card'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u23F1\\uFE0F Time Elapsed:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[timeElapsed,\" minutes\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"track-order-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>navigate('/menu'),children:\"Order More Juices\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:()=>navigate('/history'),children:\"View Order History\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:clearCurrentOrder,children:\"Clear This Order\"})]})]});};export default TrackOrder;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useLocation","OrderTracker","api","jsx","_jsx","jsxs","_jsxs","TrackOrder","_order$_id","_order$total","currentStage","setCurrentStage","order","setOrder","loading","setLoading","timeElapsed","setTimeElapsed","deliveryPerson","setDeliveryPerson","user","setUser","navigate","location","savedUser","localStorage","getItem","userData","JSON","parse","console","log","e","error","setItem","stringify","timestamp","Date","toISOString","_location$state","state","newOrder","savedOrderData","orderData","savedTime","currentTime","minutesSinceSaved","Math","floor","removeItem","fetchLatestOrder","id","ordersResponse","getUserOrders","success","Array","isArray","orders","length","latestOrder","orderTime","createdAt","minutesSinceOrder","stage","calculateStageBasedOnTime","status","minutes","statusToStage","undefined","interval","setInterval","prev","newTime","concat","setTimeout","name","rating","vehicle","phone","eta","max","clearInterval","timer","clearTimeout","_location$state2","hasLocationState","clearCurrentOrder","className","children","onClick","orderStages","description","icon","time","progressPercentage","min","_id","substring","toLocaleTimeString","title","style","width","estimatedDelivery","hour","minute","split","map","n","join","items","item","index","image","quantity","price","toFixed","total","address","toLocaleString","paymentMethod"],"sources":["D:/SEM V/Intenship Project/fresh-juice-app/frontend/src/pages/TrackOrder.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport OrderTracker from '../components/OrderTracker';\r\nimport { api } from '../services/api';\r\nimport './TrackOrder.css';\r\n\r\nconst TrackOrder = () => {\r\n  const [currentStage, setCurrentStage] = useState(0);\r\n  const [order, setOrder] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [timeElapsed, setTimeElapsed] = useState(0);\r\n  const [deliveryPerson, setDeliveryPerson] = useState(null);\r\n  const [user, setUser] = useState(null);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  // Get user from localStorage\r\n  useEffect(() => {\r\n    const savedUser = localStorage.getItem('rypeUser');\r\n    if (savedUser) {\r\n      try {\r\n        const userData = JSON.parse(savedUser);\r\n        setUser(userData);\r\n        console.log('User loaded:', userData);\r\n      } catch (e) {\r\n        console.error('Error parsing user data:', e);\r\n      }\r\n    } else {\r\n      console.log('No user found in localStorage');\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Save order to localStorage whenever it changes\r\n  useEffect(() => {\r\n    if (order) {\r\n      localStorage.setItem('rypeCurrentOrder', JSON.stringify({\r\n        order,\r\n        timestamp: new Date().toISOString(),\r\n        timeElapsed,\r\n        currentStage\r\n      }));\r\n      console.log('Order saved to localStorage');\r\n    }\r\n  }, [order, timeElapsed, currentStage]);\r\n\r\n  // Load order from localStorage or location state\r\n  useEffect(() => {\r\n    console.log('Location state:', location.state);\r\n    \r\n    // First, check if we have a new order from location state\r\n    if (location.state?.order) {\r\n      console.log('New order received from location state');\r\n      const newOrder = location.state.order;\r\n      setOrder(newOrder);\r\n      setTimeElapsed(0);\r\n      setCurrentStage(0);\r\n      \r\n      // Clear any old order from localStorage and set new one\r\n      localStorage.setItem('rypeCurrentOrder', JSON.stringify({\r\n        order: newOrder,\r\n        timestamp: new Date().toISOString(),\r\n        timeElapsed: 0,\r\n        currentStage: 0\r\n      }));\r\n      \r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // If no location state, check localStorage for existing order\r\n    const savedOrderData = localStorage.getItem('rypeCurrentOrder');\r\n    if (savedOrderData) {\r\n      try {\r\n        const orderData = JSON.parse(savedOrderData);\r\n        console.log('Found saved order in localStorage:', orderData);\r\n        \r\n        // Check if the order is still valid (less than 15 minutes old)\r\n        const savedTime = new Date(orderData.timestamp);\r\n        const currentTime = new Date();\r\n        const minutesSinceSaved = Math.floor((currentTime - savedTime) / (1000 * 60));\r\n        \r\n        if (minutesSinceSaved < 15) { // Keep order for 15 minutes\r\n          console.log('Order is still valid, loading from localStorage');\r\n          setOrder(orderData.order);\r\n          setTimeElapsed(orderData.timeElapsed + minutesSinceSaved); // Add elapsed time since last save\r\n          setCurrentStage(orderData.currentStage);\r\n        } else {\r\n          console.log('Order is too old, clearing from localStorage');\r\n          localStorage.removeItem('rypeCurrentOrder');\r\n        }\r\n      } catch (e) {\r\n        console.error('Error parsing saved order data:', e);\r\n        localStorage.removeItem('rypeCurrentOrder');\r\n      }\r\n    }\r\n    \r\n    setLoading(false);\r\n  }, [location.state]);\r\n\r\n  // Fetch user's latest order from API only if no order from localStorage or location state\r\n  useEffect(() => {\r\n    const fetchLatestOrder = async () => {\r\n      if (!user || order) { // Don't fetch if we already have an order\r\n        return;\r\n      }\r\n\r\n      try {\r\n        console.log('Fetching latest order from API for user:', user.id);\r\n        const ordersResponse = await api.getUserOrders();\r\n        console.log('Orders API response:', ordersResponse);\r\n        \r\n        if (ordersResponse.success && Array.isArray(ordersResponse.orders) && ordersResponse.orders.length > 0) {\r\n          // Get the most recent order\r\n          const latestOrder = ordersResponse.orders[0];\r\n          console.log('Latest order found from API:', latestOrder);\r\n          \r\n          // Check if this order is recent (within 15 minutes)\r\n          const orderTime = new Date(latestOrder.createdAt);\r\n          const currentTime = new Date();\r\n          const minutesSinceOrder = Math.floor((currentTime - orderTime) / (1000 * 60));\r\n          \r\n          if (minutesSinceOrder < 15) {\r\n            setOrder(latestOrder);\r\n            setTimeElapsed(minutesSinceOrder);\r\n            \r\n            // Set initial stage based on order status and time\r\n            const stage = calculateStageBasedOnTime(minutesSinceOrder, latestOrder.status);\r\n            setCurrentStage(stage);\r\n            \r\n            // Save to localStorage\r\n            localStorage.setItem('rypeCurrentOrder', JSON.stringify({\r\n              order: latestOrder,\r\n              timestamp: new Date().toISOString(),\r\n              timeElapsed: minutesSinceOrder,\r\n              currentStage: stage\r\n            }));\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching order from API:', error);\r\n      }\r\n    };\r\n\r\n    if (user && !order && !loading) {\r\n      fetchLatestOrder();\r\n    }\r\n  }, [user, order, loading]);\r\n\r\n  // Calculate stage based on time and status\r\n  const calculateStageBasedOnTime = (minutes, status) => {\r\n    const statusToStage = {\r\n      'pending': 0,\r\n      'preparing': 1,\r\n      'quality-check': 2,\r\n      'out-for-delivery': 3,\r\n      'delivered': 4\r\n    };\r\n    \r\n    // If we have a status, use it\r\n    if (status && statusToStage[status] !== undefined) {\r\n      return statusToStage[status];\r\n    }\r\n    \r\n    // Otherwise calculate based on time\r\n    if (minutes >= 15) return 4; // Delivered\r\n    if (minutes >= 8) return 3;  // Out for delivery\r\n    if (minutes >= 5) return 2;  // Quality check\r\n    if (minutes >= 2) return 1;  // Preparing\r\n    return 0; // Order placed\r\n  };\r\n\r\n  // Simulate order progress\r\n  useEffect(() => {\r\n    if (!order) return;\r\n\r\n    const interval = setInterval(() => {\r\n      setTimeElapsed(prev => {\r\n        const newTime = prev + 1;\r\n        console.log(`Time elapsed: ${newTime} minutes, Current stage: ${currentStage}`);\r\n        \r\n        // Auto-progress through stages based on time\r\n        if (newTime >= 2 && currentStage < 1) {\r\n          setCurrentStage(1); // Move to preparing\r\n        } else if (newTime >= 5 && currentStage < 2) {\r\n          setCurrentStage(2); // Move to quality check\r\n        } else if (newTime >= 8 && currentStage < 3) {\r\n          setCurrentStage(3); // Move to out for delivery\r\n        } else if (newTime >= 15 && currentStage < 4) {\r\n          setCurrentStage(4); // Move to delivered\r\n          \r\n          // Clear order from localStorage after 15 minutes when delivered\r\n          setTimeout(() => {\r\n            localStorage.removeItem('rypeCurrentOrder');\r\n            console.log('Order cleared from localStorage after completion');\r\n          }, 5000); // Clear 5 seconds after delivery\r\n        }\r\n\r\n        // Simulate delivery person assignment\r\n        if (currentStage >= 3 && !deliveryPerson) {\r\n          setDeliveryPerson({\r\n            name: 'Raj Kumar',\r\n            rating: 4.8,\r\n            vehicle: 'üö¥ Bicycle',\r\n            phone: '+91 98765 43210',\r\n            location: '1.2 km away',\r\n            eta: `${Math.max(1, 25 - newTime)} minutes`\r\n          });\r\n        }\r\n\r\n        return newTime;\r\n      });\r\n    }, 60000); // Update every minute\r\n\r\n    return () => clearInterval(interval);\r\n  }, [order, deliveryPerson, currentStage]);\r\n\r\n  // Clear order after 15 minutes (safety mechanism)\r\n  useEffect(() => {\r\n    if (timeElapsed >= 15) {\r\n      const timer = setTimeout(() => {\r\n        console.log('Auto-clearing order after 15 minutes');\r\n        localStorage.removeItem('rypeCurrentOrder');\r\n        setOrder(null);\r\n      }, 300000); // 5 minutes after delivery (20 minutes total)\r\n      \r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [timeElapsed]);\r\n\r\n  // Debug: Log current state\r\n  useEffect(() => {\r\n    console.log('Current TrackOrder state:', {\r\n      user: !!user,\r\n      order: !!order,\r\n      loading,\r\n      timeElapsed,\r\n      currentStage,\r\n      hasLocationState: !!location.state?.order\r\n    });\r\n  }, [user, order, loading, timeElapsed, currentStage, location.state]);\r\n\r\n  // Clear current order (manual function)\r\n  const clearCurrentOrder = () => {\r\n    localStorage.removeItem('rypeCurrentOrder');\r\n    setOrder(null);\r\n    setTimeElapsed(0);\r\n    setCurrentStage(0);\r\n    setDeliveryPerson(null);\r\n    console.log('Order manually cleared');\r\n  };\r\n\r\n  // Redirect to menu if no user\r\n  if (!user) {\r\n    return (\r\n      <div className=\"track-order-page\">\r\n        <div className=\"empty-state\">\r\n          <div className=\"empty-icon\">üîê</div>\r\n          <h2>Please Login to Track Orders</h2>\r\n          <p>You need to be logged in to view your order tracking information.</p>\r\n          <button \r\n            className=\"btn-primary\"\r\n            onClick={() => navigate('/')}\r\n          >\r\n            Go to Home\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"track-order-page\">\r\n        <div className=\"loading\">\r\n          <div className=\"loading-spinner\"></div>\r\n          <p>Loading your order details...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!order) {\r\n    return (\r\n      <div className=\"track-order-page\">\r\n        <div className=\"empty-state\">\r\n          <div className=\"empty-icon\">üì¶</div>\r\n          <h2>No Active Orders</h2>\r\n          <p>You haven't placed any orders recently, or your previous order has been completed.</p>\r\n          <div className=\"empty-actions\">\r\n            <button \r\n              className=\"btn-primary\"\r\n              onClick={() => navigate('/menu')}\r\n            >\r\n              Order Fresh Juices\r\n            </button>\r\n            <button \r\n              className=\"btn-secondary\"\r\n              onClick={() => navigate('/history')}\r\n            >\r\n              View Order History\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const orderStages = [\r\n    { \r\n      id: 1, \r\n      name: \"Order Placed\", \r\n      description: \"We've received your order and payment\",\r\n      icon: \"üìù\",\r\n      time: \"Just now\"\r\n    },\r\n    { \r\n      id: 2, \r\n      name: \"Preparing\", \r\n      description: \"Squeezing fresh fruits and preparing your juices\",\r\n      icon: \"üë®‚Äçüç≥\",\r\n      time: \"3-5 minutes\"\r\n    },\r\n    { \r\n      id: 3, \r\n      name: \"Quality Check\", \r\n      description: \"Ensuring perfect taste and freshness\",\r\n      icon: \"üîç\",\r\n      time: \"2-3 minutes\"\r\n    },\r\n    { \r\n      id: 4, \r\n      name: \"Out for Delivery\", \r\n      description: \"Your juices are on the way!\",\r\n      icon: \"üöö\",\r\n      time: \"10-15 minutes\"\r\n    },\r\n    { \r\n      id: 5, \r\n      name: \"Delivered\", \r\n      description: \"Enjoy your fresh juices!\",\r\n      icon: \"‚úÖ\",\r\n      time: \"Arrived\"\r\n    }\r\n  ];\r\n\r\n  const progressPercentage = Math.min((timeElapsed / 15) * 100, 100);\r\n\r\n  return (\r\n    <div className=\"track-order-page\">\r\n      <div className=\"page-header\">\r\n        <h1>Track Your Order</h1>\r\n        <p>Order #{order._id?.substring(18) || order.id} ‚Ä¢ Placed {new Date(order.createdAt).toLocaleTimeString()}</p>\r\n        <button \r\n          className=\"clear-order-btn\"\r\n          onClick={clearCurrentOrder}\r\n          title=\"Clear this order\"\r\n        >\r\n          üóëÔ∏è Clear\r\n        </button>\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      <div className=\"progress-section\">\r\n        <div className=\"progress-header\">\r\n          <h3>Delivery Progress</h3>\r\n          <span className=\"time-elapsed\">{timeElapsed} min elapsed</span>\r\n        </div>\r\n        <div className=\"progress-bar-container\">\r\n          <div \r\n            className=\"progress-bar\" \r\n            style={{ width: `${progressPercentage}%` }}\r\n          ></div>\r\n        </div>\r\n        <div className=\"progress-labels\">\r\n          <span>Ordered</span>\r\n          <span>Estimated: {order.estimatedDelivery ? new Date(order.estimatedDelivery).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : '15-20 minutes'}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Order Tracker */}\r\n      <OrderTracker \r\n        currentStage={currentStage}\r\n        orderStages={orderStages}\r\n        timeElapsed={timeElapsed}\r\n      />\r\n\r\n      {/* Delivery Person Info */}\r\n      {deliveryPerson && (\r\n        <div className=\"delivery-person-card\">\r\n          <h3>üõµ Your Delivery Partner</h3>\r\n          <div className=\"delivery-person-info\">\r\n            <div className=\"person-details\">\r\n              <div className=\"person-avatar\">{deliveryPerson.name.split(' ').map(n => n[0]).join('')}</div>\r\n              <div>\r\n                <h4>{deliveryPerson.name}</h4>\r\n                <p>‚≠ê {deliveryPerson.rating} ‚Ä¢ {deliveryPerson.vehicle}</p>\r\n                <p className=\"location\">üìç {deliveryPerson.location}</p>\r\n                <p>ETA: {deliveryPerson.eta}</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"delivery-actions\">\r\n              <button className=\"btn-secondary\">üìû Call</button>\r\n              <button className=\"btn-secondary\">üí¨ Message</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Order Details */}\r\n      <div className=\"order-details-card\">\r\n        <h3>Your Order Details</h3>\r\n        \r\n        <div className=\"order-items-list\">\r\n          <h4>Items Ordered:</h4>\r\n          {order.items && order.items.map((item, index) => (\r\n            <div key={index} className=\"order-item\">\r\n              <div className=\"item-info\">\r\n                <span className=\"item-image\">{item.image || 'üçä'}</span>\r\n                <div>\r\n                  <strong>{item.name || 'Fresh Juice'}</strong>\r\n                  <p>Quantity: {item.quantity || 1}</p>\r\n                </div>\r\n              </div>\r\n              <span className=\"item-price\">‚Çπ{((item.price || 0) * (item.quantity || 1)).toFixed(2)}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        \r\n        <div className=\"order-total\">\r\n          <strong>Total: ‚Çπ{order.total?.toFixed(2) || '0.00'}</strong>\r\n        </div>\r\n        \r\n        <div className=\"delivery-info\">\r\n          <h4>Delivery Information:</h4>\r\n          <div className=\"info-item\">\r\n            <span>üì¶ Delivery Address:</span>\r\n            <span>{order.address || user.address || 'Address not specified'}</span>\r\n          </div>\r\n          <div className=\"info-item\">\r\n            <span>üë§ Customer:</span>\r\n            <span>{user.name}</span>\r\n          </div>\r\n          <div className=\"info-item\">\r\n            <span>üìû Contact:</span>\r\n            <span>{user.phone || 'Not provided'}</span>\r\n          </div>\r\n          <div className=\"info-item\">\r\n            <span>‚è∞ Ordered at:</span>\r\n            <span>{new Date(order.createdAt).toLocaleString()}</span>\r\n          </div>\r\n          <div className=\"info-item\">\r\n            <span>üí≥ Payment Method:</span>\r\n            <span>{order.paymentMethod || 'Card'}</span>\r\n          </div>\r\n          <div className=\"info-item\">\r\n            <span>‚è±Ô∏è Time Elapsed:</span>\r\n            <span>{timeElapsed} minutes</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Action Buttons */}\r\n      <div className=\"track-order-actions\">\r\n        <button \r\n          className=\"btn-primary\"\r\n          onClick={() => navigate('/menu')}\r\n        >\r\n          Order More Juices\r\n        </button>\r\n        <button \r\n          className=\"btn-secondary\"\r\n          onClick={() => navigate('/history')}\r\n        >\r\n          View Order History\r\n        </button>\r\n        <button \r\n          className=\"btn-secondary\"\r\n          onClick={clearCurrentOrder}\r\n        >\r\n          Clear This Order\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TrackOrder;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}